apiVersion: v1
kind: ConfigMap
metadata:
  name: mongodb-init-script
  namespace: diaspomoney-prod
  labels:
    app: diaspomoney
    component: mongodb
data:
  mongo-init.js: |
    // Script d'initialisation MongoDB
    db = db.getSiblingDB('diaspomoney');
    
    // Créer un utilisateur pour l'application
    db.createUser({
      user: 'diaspomoney',
      pwd: 'CHANGE_ME_IN_SECRET',
      roles: [
        {
          role: 'readWrite',
          db: 'diaspomoney'
        }
      ]
    });
    
    // Créer des collections initiales si nécessaire
    db.createCollection('users');
    db.createCollection('transactions');
    db.createCollection('bookings');
    db.createCollection('invoices');
    
    print('Database initialized successfully');

